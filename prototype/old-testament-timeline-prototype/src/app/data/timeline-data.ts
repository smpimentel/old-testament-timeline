// Old Testament Timeline Data - Production Ready
// Exact date model with certainty indicators

export type EntityType = 'person' | 'event' | 'book';
export type PersonRole = 'king' | 'prophet' | 'judge' | 'priest' | 'patriarch' | 'warrior' | 'scribe' | 'other';
export type EventCategory = 'war' | 'treaty' | 'discovery' | 'construction' | 'festival' | 'succession' | 'disaster' | 'renaissance';
export type BookGenre = 'political' | 'cultural' | 'religious' | 'economic' | 'military' | 'scientific' | 'agricultural' | 'maritime';
export type DateCertainty = 'exact' | 'approximate';
export type ThemeTag = 'Covenant' | 'Kingship' | 'Land' | 'Messiah';

export interface TimelineEntity {
  id: string;
  type: EntityType;
  name: string;
  startYear: number;
  endYear?: number;
  certainty: DateCertainty;
  priority: 1 | 2 | 3 | 4;
  description: string;
  themes?: ThemeTag[];
  role?: PersonRole;
  category?: EventCategory;
  genre?: BookGenre;
  relationships?: string[];
  scripture?: string;
  notes?: string;
  swimlane?: number; // Assigned by collision detection
}

export interface Period {
  id: string;
  name: string;
  startYear: number;
  endYear: number;
  color: string;
}

// ===== PERIODS =====
export const periods: Period[] = [
  { id: 'unknown', name: 'Dates Unknown', startYear: 4000, endYear: 3500, color: '#E8DCC8' },
  { id: 'patriarchs', name: 'Patriarchs', startYear: 3500, endYear: 1876, color: '#C8D4B8' },
  { id: 'egypt', name: 'Egypt', startYear: 1876, endYear: 1446, color: '#F4D19B' },
  { id: 'wandering', name: 'Wandering', startYear: 1446, endYear: 1406, color: '#B8D9E6' },
  { id: 'judges', name: 'Judges', startYear: 1406, endYear: 1050, color: '#B8C4A8' },
  { id: 'united', name: 'United Kingdom', startYear: 1050, endYear: 931, color: '#F5D99F' },
  { id: 'divided', name: 'Divided Kingdom', startYear: 931, endYear: 586, color: '#D4B5D4' },
  { id: 'exile', name: 'Exile', startYear: 586, endYear: 538, color: '#C8C4BC' },
  { id: 'restoration', name: 'Restoration', startYear: 538, endYear: 400, color: '#A8D5E2' },
];

// ===== TIMELINE DATA =====
export const timelineData: TimelineEntity[] = [
  // ===== PEOPLE =====
  {
    id: 'abraham',
    type: 'person',
    name: 'Abraham',
    startYear: 2166,
    endYear: 1991,
    certainty: 'approximate',
    priority: 1,
    role: 'patriarch',
    description: 'Father of the Hebrew nation, called by God to leave Ur',
    themes: ['Covenant', 'Land'],
    relationships: ['isaac', 'call-abraham', 'genesis'],
    scripture: 'Genesis 12-25',
    notes: 'Covenant promise: "I will make you into a great nation" (Gen 12:2). Known for radical faith and obedience.',
  },
  {
    id: 'isaac',
    type: 'person',
    name: 'Isaac',
    startYear: 2066,
    endYear: 1886,
    certainty: 'approximate',
    priority: 2,
    role: 'patriarch',
    description: 'Son of Abraham, father of Jacob and Esau',
    themes: ['Covenant', 'Land'],
    relationships: ['abraham', 'jacob', 'genesis'],
    scripture: 'Genesis 21-35',
    notes: 'The promised son through whom the covenant continued.',
  },
  {
    id: 'jacob',
    type: 'person',
    name: 'Jacob',
    startYear: 2006,
    endYear: 1859,
    certainty: 'approximate',
    priority: 2,
    role: 'patriarch',
    description: 'Son of Isaac, renamed Israel, father of twelve tribes',
    themes: ['Covenant', 'Land'],
    relationships: ['isaac', 'joseph', 'genesis'],
    scripture: 'Genesis 25-50',
    notes: 'Wrestled with God and received the name Israel. Father of the twelve tribes.',
  },
  {
    id: 'joseph',
    type: 'person',
    name: 'Joseph',
    startYear: 1915,
    endYear: 1805,
    certainty: 'approximate',
    priority: 2,
    role: 'other',
    description: 'Son of Jacob, sold into slavery, became vizier of Egypt',
    themes: ['Covenant'],
    relationships: ['jacob', 'genesis'],
    scripture: 'Genesis 37-50',
    notes: 'Preserved the family of Israel during famine through divine providence.',
  },
  {
    id: 'moses',
    type: 'person',
    name: 'Moses',
    startYear: 1526,
    endYear: 1406,
    certainty: 'approximate',
    priority: 1,
    role: 'prophet',
    description: 'Deliverer of Israel from Egypt, lawgiver, mediator of the covenant',
    themes: ['Covenant', 'Land'],
    relationships: ['exodus-event', 'exodus', 'leviticus', 'numbers', 'deuteronomy'],
    scripture: 'Exodus 2-Deuteronomy 34',
    notes: 'Led Israel out of Egypt and received the Law on Mount Sinai. Spoke with God face to face.',
  },
  {
    id: 'joshua',
    type: 'person',
    name: 'Joshua',
    startYear: 1495,
    endYear: 1385,
    certainty: 'approximate',
    priority: 2,
    role: 'warrior',
    description: 'Moses\' successor, led conquest of Canaan',
    themes: ['Land'],
    relationships: ['moses', 'joshua-book'],
    scripture: 'Numbers 13-14, Joshua',
    notes: 'Successfully led Israel into the Promised Land and divided it among the tribes.',
  },
  {
    id: 'samuel',
    type: 'person',
    name: 'Samuel',
    startYear: 1105,
    endYear: 1012,
    certainty: 'approximate',
    priority: 1,
    role: 'prophet',
    description: 'Last judge, anointed first two kings of Israel',
    themes: ['Kingship', 'Covenant'],
    relationships: ['saul', 'david', 'samuel-books'],
    scripture: '1 Samuel',
    notes: 'Transitioned Israel from judges to monarchy. Anointed both Saul and David.',
  },
  {
    id: 'saul',
    type: 'person',
    name: 'Saul',
    startYear: 1050,
    endYear: 1010,
    certainty: 'approximate',
    priority: 2,
    role: 'king',
    description: 'First king of Israel, eventually rejected by God',
    themes: ['Kingship'],
    relationships: ['samuel', 'david', 'samuel-books'],
    scripture: '1 Samuel 9-31',
    notes: 'Initially successful but disobedience led to rejection and eventual tragedy.',
  },
  {
    id: 'david',
    type: 'person',
    name: 'David',
    startYear: 1040,
    endYear: 970,
    certainty: 'approximate',
    priority: 1,
    role: 'king',
    description: 'Greatest king of Israel, man after God\'s own heart, ancestor of Messiah',
    themes: ['Kingship', 'Messiah', 'Covenant'],
    relationships: ['saul', 'solomon', 'samuel-books', 'psalms'],
    scripture: '1-2 Samuel, 1 Kings 1-2',
    notes: 'United the kingdom, established Jerusalem as capital. Davidic covenant promises eternal dynasty.',
  },
  {
    id: 'solomon',
    type: 'person',
    name: 'Solomon',
    startYear: 990,
    endYear: 931,
    certainty: 'approximate',
    priority: 1,
    role: 'king',
    description: 'Son of David, builder of the temple, wisest man',
    themes: ['Kingship'],
    relationships: ['david', 'temple-built', 'proverbs', 'ecclesiastes'],
    scripture: '1 Kings 1-11, 2 Chronicles 1-9',
    notes: 'Built the First Temple. Known for wisdom but led astray by foreign wives.',
  },
  {
    id: 'elijah',
    type: 'person',
    name: 'Elijah',
    startYear: 875,
    endYear: 848,
    certainty: 'approximate',
    priority: 2,
    role: 'prophet',
    description: 'Prophet who confronted Ahab and Jezebel, taken to heaven',
    themes: ['Covenant'],
    relationships: ['elisha'],
    scripture: '1 Kings 17-2 Kings 2',
    notes: 'Confronted Baal worship. Never died but was taken to heaven in a whirlwind.',
  },
  {
    id: 'elisha',
    type: 'person',
    name: 'Elisha',
    startYear: 850,
    endYear: 795,
    certainty: 'approximate',
    priority: 3,
    role: 'prophet',
    description: 'Elijah\'s successor, performed many miracles',
    themes: ['Covenant'],
    relationships: ['elijah'],
    scripture: '1 Kings 19, 2 Kings 2-13',
    notes: 'Received double portion of Elijah\'s spirit. Ministry of miracles and healing.',
  },
  {
    id: 'isaiah',
    type: 'person',
    name: 'Isaiah',
    startYear: 740,
    endYear: 681,
    certainty: 'approximate',
    priority: 1,
    role: 'prophet',
    description: 'Major prophet, foretold Messiah\'s coming',
    themes: ['Messiah', 'Covenant'],
    relationships: ['isaiah-book'],
    scripture: 'Book of Isaiah',
    notes: 'Most quoted OT prophet in NT. Messianic prophecies (ch 7, 9, 11, 53) are foundational.',
  },
  {
    id: 'jeremiah',
    type: 'person',
    name: 'Jeremiah',
    startYear: 655,
    endYear: 580,
    certainty: 'approximate',
    priority: 2,
    role: 'prophet',
    description: 'Weeping prophet, warned of Babylonian exile',
    themes: ['Covenant'],
    relationships: ['jeremiah-book', 'exile-event'],
    scripture: 'Book of Jeremiah',
    notes: 'Prophesied destruction of Jerusalem and the exile. Promised new covenant (Jer 31).',
  },
  {
    id: 'ezekiel',
    type: 'person',
    name: 'Ezekiel',
    startYear: 622,
    endYear: 570,
    certainty: 'approximate',
    priority: 3,
    role: 'prophet',
    description: 'Prophet during Babylonian exile, had dramatic visions',
    themes: ['Covenant'],
    relationships: ['ezekiel-book', 'exile-event'],
    scripture: 'Book of Ezekiel',
    notes: 'Prophesied during exile. Vision of dry bones (ch 37) promises restoration.',
  },
  {
    id: 'daniel',
    type: 'person',
    name: 'Daniel',
    startYear: 620,
    endYear: 538,
    certainty: 'approximate',
    priority: 2,
    role: 'prophet',
    description: 'Faithful in exile, interpreter of dreams, apocalyptic visions',
    themes: ['Messiah'],
    relationships: ['daniel-book', 'exile-event'],
    scripture: 'Book of Daniel',
    notes: 'Served in Babylonian and Persian courts. Seventy weeks prophecy points to Messiah.',
  },
  {
    id: 'ezra',
    type: 'person',
    name: 'Ezra',
    startYear: 480,
    endYear: 440,
    certainty: 'approximate',
    priority: 3,
    role: 'scribe',
    description: 'Priest and scribe, led spiritual renewal',
    themes: ['Covenant'],
    relationships: ['ezra-book'],
    scripture: 'Book of Ezra',
    notes: 'Led return from exile and restoration of the Law in Jerusalem.',
  },
  {
    id: 'nehemiah',
    type: 'person',
    name: 'Nehemiah',
    startYear: 465,
    endYear: 410,
    certainty: 'approximate',
    priority: 3,
    role: 'other',
    description: 'Cupbearer to king, rebuilt Jerusalem walls',
    themes: ['Land'],
    relationships: ['nehemiah-book'],
    scripture: 'Book of Nehemiah',
    notes: 'Rebuilt Jerusalem walls in 52 days despite opposition. Governor and reformer.',
  },

  // ===== EVENTS =====
  {
    id: 'flood',
    type: 'event',
    name: 'The Flood',
    startYear: 2348,
    certainty: 'approximate',
    priority: 2,
    category: 'disaster',
    description: 'Global flood, Noah and family preserved in ark',
    themes: ['Covenant'],
    relationships: ['genesis'],
    scripture: 'Genesis 6-9',
    notes: 'God\'s judgment on wickedness. Covenant with Noah (rainbow sign).',
  },
  {
    id: 'call-abraham',
    type: 'event',
    name: 'Call of Abraham',
    startYear: 2091,
    certainty: 'approximate',
    priority: 1,
    category: 'discovery',
    description: 'God calls Abram to leave Ur and go to Canaan',
    themes: ['Covenant', 'Land'],
    relationships: ['abraham', 'genesis'],
    scripture: 'Genesis 12',
    notes: 'Foundational covenant promise: land, descendants, blessing to all nations.',
  },
  {
    id: 'exodus-event',
    type: 'event',
    name: 'The Exodus',
    startYear: 1446,
    certainty: 'exact',
    priority: 1,
    category: 'renaissance',
    description: 'Israel delivered from Egyptian slavery',
    themes: ['Covenant', 'Land'],
    relationships: ['moses', 'exodus'],
    scripture: 'Exodus 1-15',
    notes: 'Defining event of Israel\'s identity. Passover instituted. Red Sea crossing.',
  },
  {
    id: 'sinai-covenant',
    type: 'event',
    name: 'Sinai Covenant',
    startYear: 1445,
    certainty: 'exact',
    priority: 1,
    category: 'treaty',
    description: 'God gives the Law to Moses on Mount Sinai',
    themes: ['Covenant'],
    relationships: ['moses', 'exodus', 'leviticus'],
    scripture: 'Exodus 19-24',
    notes: 'Ten Commandments and covenant ratified. "If you obey... you will be my treasured possession."',
  },
  {
    id: 'temple-built',
    type: 'event',
    name: 'Temple Built',
    startYear: 957,
    certainty: 'approximate',
    priority: 1,
    category: 'construction',
    description: 'Solomon builds the First Temple in Jerusalem',
    themes: ['Covenant'],
    relationships: ['solomon'],
    scripture: '1 Kings 6-8',
    notes: 'Central place of worship. God\'s glory fills the temple.',
  },
  {
    id: 'kingdom-divided',
    type: 'event',
    name: 'Kingdom Divided',
    startYear: 931,
    certainty: 'approximate',
    priority: 2,
    category: 'succession',
    description: 'Israel splits into northern (Israel) and southern (Judah) kingdoms',
    themes: ['Kingship'],
    relationships: ['solomon'],
    scripture: '1 Kings 12',
    notes: 'Consequence of Solomon\'s idolatry. Jeroboam leads north, Rehoboam leads south.',
  },
  {
    id: 'fall-israel',
    type: 'event',
    name: 'Fall of Northern Kingdom',
    startYear: 722,
    certainty: 'exact',
    priority: 2,
    category: 'war',
    description: 'Assyria conquers Israel, ten tribes exiled',
    themes: ['Covenant'],
    relationships: [],
    scripture: '2 Kings 17',
    notes: 'Judgment for persistent idolatry and covenant breaking.',
  },
  {
    id: 'exile-event',
    type: 'event',
    name: 'Babylonian Exile',
    startYear: 586,
    certainty: 'exact',
    priority: 1,
    category: 'disaster',
    description: 'Babylon destroys Jerusalem and temple, Judah exiled',
    themes: ['Covenant', 'Land'],
    relationships: ['jeremiah', 'ezekiel', 'daniel'],
    scripture: '2 Kings 25, 2 Chronicles 36',
    notes: 'Temple destroyed. Seventy-year exile prophesied by Jeremiah.',
  },
  {
    id: 'return-exile',
    type: 'event',
    name: 'Return from Exile',
    startYear: 538,
    certainty: 'exact',
    priority: 2,
    category: 'renaissance',
    description: 'Cyrus of Persia allows Jews to return to Jerusalem',
    themes: ['Land', 'Covenant'],
    relationships: ['ezra', 'nehemiah'],
    scripture: 'Ezra 1-2',
    notes: 'Fulfillment of prophecy. First wave returns under Zerubbabel.',
  },

  // ===== BOOKS =====
  {
    id: 'genesis',
    type: 'book',
    name: 'Genesis',
    startYear: 2200,
    endYear: 1800,
    certainty: 'approximate',
    priority: 1,
    genre: 'religious',
    description: 'Book of beginnings: creation, fall, flood, patriarchs',
    themes: ['Covenant', 'Land'],
    relationships: ['abraham', 'isaac', 'jacob', 'joseph'],
    scripture: 'Genesis',
    notes: 'Covers from creation to Joseph in Egypt. Foundation for all Scripture.',
  },
  {
    id: 'exodus',
    type: 'book',
    name: 'Exodus',
    startYear: 1500,
    endYear: 1450,
    certainty: 'approximate',
    priority: 1,
    genre: 'religious',
    description: 'Deliverance from Egypt, Law given at Sinai, tabernacle',
    themes: ['Covenant', 'Land'],
    relationships: ['moses', 'exodus-event'],
    scripture: 'Exodus',
    notes: 'Liberation, covenant, and presence of God. Passover and tabernacle instituted.',
  },
  {
    id: 'leviticus',
    type: 'book',
    name: 'Leviticus',
    startYear: 1450,
    endYear: 1445,
    certainty: 'approximate',
    priority: 3,
    genre: 'religious',
    description: 'Laws for worship, sacrifice, and holiness',
    themes: ['Covenant'],
    relationships: ['moses'],
    scripture: 'Leviticus',
    notes: 'Priestly manual. "Be holy because I am holy" (Lev 11:45).',
  },
  {
    id: 'numbers',
    type: 'book',
    name: 'Numbers',
    startYear: 1445,
    endYear: 1406,
    certainty: 'approximate',
    priority: 3,
    genre: 'religious',
    description: 'Wilderness wanderings, censuses, rebellion',
    themes: ['Covenant', 'Land'],
    relationships: ['moses'],
    scripture: 'Numbers',
    notes: 'Forty years of testing in wilderness due to unbelief.',
  },
  {
    id: 'deuteronomy',
    type: 'book',
    name: 'Deuteronomy',
    startYear: 1406,
    certainty: 'approximate',
    priority: 2,
    genre: 'religious',
    description: 'Moses\' final sermons, covenant renewal',
    themes: ['Covenant', 'Land'],
    relationships: ['moses'],
    scripture: 'Deuteronomy',
    notes: 'Covenant renewal before entering Promised Land. Shema (Deut 6:4-5).',
  },
  {
    id: 'joshua-book',
    type: 'book',
    name: 'Joshua',
    startYear: 1406,
    endYear: 1385,
    certainty: 'approximate',
    priority: 2,
    genre: 'military',
    description: 'Conquest and division of Canaan',
    themes: ['Land'],
    relationships: ['joshua'],
    scripture: 'Joshua',
    notes: 'Fulfillment of land promise. "Be strong and courageous" (Josh 1:9).',
  },
  {
    id: 'samuel-books',
    type: 'book',
    name: '1-2 Samuel',
    startYear: 1105,
    endYear: 970,
    certainty: 'approximate',
    priority: 1,
    genre: 'political',
    description: 'Transition from judges to monarchy, Saul and David',
    themes: ['Kingship', 'Messiah', 'Covenant'],
    relationships: ['samuel', 'saul', 'david'],
    scripture: '1-2 Samuel',
    notes: 'Davidic covenant (2 Sam 7) foundational for messianic hope.',
  },
  {
    id: 'psalms',
    type: 'book',
    name: 'Psalms',
    startYear: 1000,
    endYear: 500,
    certainty: 'approximate',
    priority: 1,
    genre: 'cultural',
    description: 'Worship songs, prayers, and poems',
    themes: ['Covenant', 'Messiah', 'Kingship'],
    relationships: ['david'],
    scripture: 'Psalms',
    notes: 'Hymnbook of Israel. Many psalms by David. Messianic psalms (2, 22, 110).',
  },
  {
    id: 'proverbs',
    type: 'book',
    name: 'Proverbs',
    startYear: 970,
    endYear: 930,
    certainty: 'approximate',
    priority: 3,
    genre: 'cultural',
    description: 'Wisdom sayings for practical living',
    themes: [],
    relationships: ['solomon'],
    scripture: 'Proverbs',
    notes: 'Wisdom literature. "Fear of the LORD is beginning of wisdom" (Prov 9:10).',
  },
  {
    id: 'ecclesiastes',
    type: 'book',
    name: 'Ecclesiastes',
    startYear: 935,
    certainty: 'approximate',
    priority: 4,
    genre: 'cultural',
    description: 'Reflections on meaning and vanity of life',
    themes: [],
    relationships: ['solomon'],
    scripture: 'Ecclesiastes',
    notes: 'Life "under the sun" without God is meaningless.',
  },
  {
    id: 'isaiah-book',
    type: 'book',
    name: 'Isaiah',
    startYear: 740,
    endYear: 680,
    certainty: 'approximate',
    priority: 1,
    genre: 'religious',
    description: 'Major prophet, judgment and messianic hope',
    themes: ['Messiah', 'Covenant'],
    relationships: ['isaiah'],
    scripture: 'Isaiah',
    notes: 'Suffering Servant (ch 53) most detailed Messianic prophecy in OT.',
  },
  {
    id: 'jeremiah-book',
    type: 'book',
    name: 'Jeremiah',
    startYear: 627,
    endYear: 580,
    certainty: 'approximate',
    priority: 2,
    genre: 'religious',
    description: 'Prophet of judgment and new covenant',
    themes: ['Covenant'],
    relationships: ['jeremiah'],
    scripture: 'Jeremiah',
    notes: 'New covenant promise (Jer 31:31-34) fulfilled in Christ.',
  },
  {
    id: 'ezekiel-book',
    type: 'book',
    name: 'Ezekiel',
    startYear: 593,
    endYear: 571,
    certainty: 'approximate',
    priority: 3,
    genre: 'religious',
    description: 'Visions during exile, temple restoration',
    themes: ['Covenant'],
    relationships: ['ezekiel'],
    scripture: 'Ezekiel',
    notes: 'Vision of God\'s glory and future temple.',
  },
  {
    id: 'daniel-book',
    type: 'book',
    name: 'Daniel',
    startYear: 605,
    endYear: 530,
    certainty: 'approximate',
    priority: 2,
    genre: 'religious',
    description: 'Prophecies of world empires and Messiah\'s kingdom',
    themes: ['Messiah', 'Kingship'],
    relationships: ['daniel'],
    scripture: 'Daniel',
    notes: 'Apocalyptic visions. Seventy weeks prophecy (Dan 9:24-27).',
  },
  {
    id: 'ezra-book',
    type: 'book',
    name: 'Ezra',
    startYear: 538,
    endYear: 457,
    certainty: 'approximate',
    priority: 3,
    genre: 'political',
    description: 'Return from exile, temple rebuilt',
    themes: ['Land', 'Covenant'],
    relationships: ['ezra'],
    scripture: 'Ezra',
    notes: 'Restoration of worship and the Law.',
  },
  {
    id: 'nehemiah-book',
    type: 'book',
    name: 'Nehemiah',
    startYear: 445,
    endYear: 420,
    certainty: 'approximate',
    priority: 3,
    genre: 'political',
    description: 'Jerusalem walls rebuilt, covenant renewed',
    themes: ['Land', 'Covenant'],
    relationships: ['nehemiah'],
    scripture: 'Nehemiah',
    notes: 'Physical and spiritual restoration of Jerusalem.',
  },
];

// ===== THEME ACCENT MAPPING (LOCKED) =====
export const themeColors: Record<ThemeTag, string> = {
  'Covenant': '#F4D19B',      // Egyptian Amber
  'Kingship': '#D4B5D4',      // Roman Purple
  'Land': '#C8D4B8',          // Olive Grove
  'Messiah': '#A8D5E2',       // Mediterranean Blue
};

// ===== ROLE COLOR MAPPING =====
export const roleColors: Record<PersonRole, string> = {
  'king': '#F5D99F',
  'prophet': '#C8B8D4',
  'judge': '#B8C4A8',
  'priest': '#D4C5E0',
  'patriarch': '#C8D4B8',
  'warrior': '#D9B5A0',
  'scribe': '#E6DCC8',
  'other': '#D4D9DE',
};

// ===== EVENT CATEGORY COLOR MAPPING =====
export const eventColors: Record<EventCategory, string> = {
  'war': '#E6A8A8',
  'treaty': '#E0E6E8',
  'discovery': '#B8D9E6',
  'construction': '#E6D4B8',
  'festival': '#F0C8D4',
  'succession': '#CFB8D4',
  'disaster': '#C8C4BC',
  'renaissance': '#F4E0C8',
};

// ===== BOOK GENRE COLOR MAPPING =====
export const genreColors: Record<BookGenre, string> = {
  'political': '#A8C4E0',
  'cultural': '#F4D4C8',
  'religious': '#D4C8E0',
  'economic': '#E6D4A8',
  'military': '#D9B8A8',
  'scientific': '#B8DDE0',
  'agricultural': '#C8D9B8',
  'maritime': '#B8CFD9',
};

// ===== SWIMLANE COLLISION DETECTION =====
export function assignSwimlanes(entities: TimelineEntity[]): TimelineEntity[] {
  const byType = {
    person: entities.filter(e => e.type === 'person'),
    event: entities.filter(e => e.type === 'event'),
    book: entities.filter(e => e.type === 'book'),
  };

  Object.values(byType).forEach(group => {
    // Sort by start year
    const sorted = group.sort((a, b) => b.startYear - a.startYear);
    
    // Assign lanes
    const lanes: Array<{ end: number }> = [];
    
    sorted.forEach(entity => {
      const end = entity.endYear || entity.startYear;
      
      // Find first lane without collision
      let laneIndex = lanes.findIndex(lane => lane.end > entity.startYear);
      
      if (laneIndex === -1) {
        // No collision, create new lane
        laneIndex = lanes.length;
        lanes.push({ end });
      } else {
        // Update lane end
        lanes[laneIndex].end = Math.min(lanes[laneIndex].end, end);
      }
      
      entity.swimlane = laneIndex;
    });
  });

  return entities;
}

// Assign swimlanes on load
assignSwimlanes(timelineData);
